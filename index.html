<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi Novia ‚ù§Ô∏è</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ù§Ô∏è</text></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    
    <style>
        /* --- VARIABLES DE COLORES --- */
        :root {
            /* MODO NORMAL (ROSA) */
            --bg-color: #fff0f5;
            --text-color: #5a2a2a;
            --primary-color: #d63384;
            --card-bg: white;
            --font-main: 'Fredoka', sans-serif;
            --player-border: 2px solid #ffb6c1;
            --player-radius: 15px;
            --idea-bg: #ffe4e1;
            --cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewport="0 0 100 100" style="fill:black;font-size:15px;"><text y="50%">‚ú®</text></svg>') 16 0, auto;
        }

        /* MODO STARDEW (PIXEL ART) */
        body.stardew-mode {
            --bg-color: #0c0c24;
            --text-color: #4a2c18;
            --primary-color: #e37222;
            --card-bg: #fdf5e6;
            --font-main: 'VT323', monospace;
            --player-border: 4px solid #8b4513;
            --player-radius: 5px;
            --idea-bg: #fff8e7;
            --cursor: auto; 
        }

        /* --- ESTILOS BASE --- */
        body {
            font-family: var(--font-main);
            text-align: center; margin: 0; padding: 0;
            overflow-x: hidden; color: var(--text-color); 
            padding-bottom: 300px;
            cursor: var(--cursor);
            position: relative; 
            background-color: var(--bg-color);
            transition: background-color 1s ease, color 0.5s ease;
        }

        /* --- FONDOS --- */
        .bg-tunnel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -5;
            background: repeating-radial-gradient(circle at center, #fff5f7 0%, #fff5f7 20px, #ffe4e1 20px, #ffe4e1 40px, #ffccd5 40px, #ffccd5 60px, #ffb6c1 60px, #ffb6c1 80px);
            background-position: center center;
            animation: tunnelPulse 6s ease-in-out infinite alternate;
            transition: opacity 1s ease; opacity: 1;
        }
        @keyframes tunnelPulse { 0% { background-size: 100% 100%; } 100% { background-size: 120% 120%; } }

        .bg-stardew {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -4;
            background-image: url('https://i.pinimg.com/1200x/95/26/f0/9526f08c1e26dcb4f6b9afd9d76af8ab.jpg'); 
            background-size: cover; background-position: center;
            opacity: 0; transition: opacity 1s ease;
        }

        body.stardew-mode .bg-tunnel { opacity: 0; }
        body.stardew-mode .bg-stardew { opacity: 1; }

        /* --- COMPONENTES --- */
        .container { max-width: 800px; margin: 0 auto; padding: 20px; position: relative; z-index: 10; }

        h1 { 
            color: var(--primary-color); margin-top: 30px; 
            font-size: 2.8rem; text-transform: uppercase; letter-spacing: 2px; 
            text-shadow: 2px 2px 0px white; transition: color 0.5s;
        }
        body.stardew-mode h1 { text-shadow: 4px 4px 0px #000; font-size: 4rem; }

        #contador {
            background: var(--card-bg); padding: 15px 30px;
            border-radius: 50px; border: none; box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3);
            margin: 20px auto; display: inline-block; font-size: 1.2rem;
            color: var(--primary-color); font-weight: bold; transition: all 0.5s;
        }
        body.stardew-mode #contador { border-radius: 5px; font-size: 1.5rem; box-shadow: 4px 4px 0px #3e2723; border: 4px solid #8b4513; }

        .gallery { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 40px; }
        .photo-card {
            background: var(--card-bg); padding: 12px; border-radius: 12px;
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3); transition: transform 0.3s ease; width: 200px;
        }
        body.stardew-mode .photo-card { border-radius: 2px; border: 4px solid #8b4513; box-shadow: 4px 4px 0px #3e2723; }
        .photo-card:hover { transform: scale(1.1) rotate(0deg) !important; z-index: 20; }
        .photo-card img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
        body.stardew-mode .photo-card img { border-radius: 2px; border: 2px solid #8b4513; }
        .photo-card p { margin-top: 10px; font-weight: bold; color: var(--primary-color); text-transform: uppercase; font-size: 0.9rem; }
        body.stardew-mode .photo-card p { font-size: 1.2rem; }

        /* CARTA */
        .carta-section { margin-top: 60px; display: flex; justify-content: center; }
        .papel-carta {
            background: var(--card-bg); width: 100%; max-width: 600px; padding: 40px;
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3); position: relative;
            text-align: left; line-height: 1.8; font-size: 1.1rem; color: var(--text-color);
            min-height: 300px; transition: all 0.5s;
        }
        body:not(.stardew-mode) .papel-carta {
            background-image: linear-gradient(#999 0.05em, transparent 0.1em);
            background-size: 100% 2em;
        }
        body.stardew-mode .papel-carta {
            background-color: #fceecb; border-radius: 5px; font-size: 1.3rem; border: 4px solid #8b4513; box-shadow: 4px 4px 0px #3e2723;
        }

        /* UTILIDADES */
        .utility-section {
            margin-top: 50px; background: var(--card-bg);
            padding: 30px; border-radius: 20px;
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3);
            max-width: 600px; margin-left: auto; margin-right: auto;
            text-align: center; 
        }
        body.stardew-mode .utility-section { border-radius: 5px; border: 4px solid #8b4513; box-shadow: 4px 4px 0px #3e2723; }

        .utility-box { margin-bottom: 30px; }
        .utility-title { color: var(--primary-color); font-size: 1.5rem; margin-bottom: 15px; text-transform: uppercase; }

        .date-list { padding: 0; list-style: none; text-align: left; }
        .date-item {
            background: var(--bg-color); margin-bottom: 10px; padding: 10px 15px;
            border-radius: 10px; display: flex; justify-content: space-between;
            font-size: 1.1rem; border-left: 5px solid var(--primary-color);
        }
        body.stardew-mode .date-item { border-radius: 2px; background: #e6ccb2; }

        /* Cuadro de ideas */
        #idea-display {
            background: var(--idea-bg); padding: 20px; border-radius: 10px;
            margin-bottom: 15px; font-style: italic;
            display: flex; align-items: center; justify-content: center;
            min-height: 60px; font-size: 1.2rem; color: var(--text-color);
        }
        body.stardew-mode #idea-display { border-radius: 5px; border: 2px dashed #8b4513; }

        /* BOTONES */
        .btn-frases, .btn-idea, .btn-entrar {
            background: var(--primary-color); color: white; border: none;
            padding: 15px 40px; border-radius: 50px; font-size: 1.2rem;
            font-weight: bold; cursor: pointer;
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3); transition: all 0.2s; font-family: var(--font-main);
            text-transform: uppercase;
        }
        body.stardew-mode .btn-frases, body.stardew-mode .btn-idea, body.stardew-mode .btn-entrar {
            border-radius: 5px; border: 3px solid #3e0e00; box-shadow: 4px 4px 0 #000;
        }
        .btn-frases:hover, .btn-idea:hover, .btn-entrar:hover { transform: scale(1.05); filter: brightness(1.1); }
        .btn-frases { margin-top: 60px; }

        /* BOTON MODO - OCULTO INICIO */
        #btn-toggle-mode {
            position: fixed; top: 20px; left: 20px; z-index: 2000;
            background: white; border: 2px solid #5a2a2a;
            padding: 10px 15px; border-radius: 10px; cursor: pointer;
            font-family: 'Fredoka', sans-serif; font-weight: bold;
            box-shadow: 0 4px 0 #5a2a2a; 
            transition: transform 0.1s, opacity 2s ease;
            opacity: 0; pointer-events: none;
        }
        #btn-toggle-mode:active { transform: translateY(4px); box-shadow: 0 0 0; }
        body.stardew-mode #btn-toggle-mode {
            background: #ff9900; color: #3e0e00; border: 4px solid #3e0e00;
            font-family: 'VT323', monospace; font-size: 1.2rem; box-shadow: 4px 4px 0 #3e0e00;
        }

        /* --- EXTRAS Y PANTALLA BLOQUEO --- */
        .corner-sticker { position: fixed; font-size: 3rem; z-index: 90; cursor: pointer; transition: transform 0.3s; }
        .bottom-left { bottom: 20px; left: 20px; transform: rotate(-15deg); }
        .bottom-right { bottom: 20px; right: 20px; transform: rotate(15deg); }
        .corner-sticker:hover { transform: scale(1.3); }

        #pantalla-bloqueo { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: transparent; backdrop-filter: blur(2px);
            z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; 
            transition: opacity 1s ease; 
        }
        .caja-login { 
            background: white; padding: 40px; border-radius: 20px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
            border: 3px solid #ffb6c1; max-width: 90%; text-align: center; 
        }
        .fecha-inputs-container { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 15px; }
        .input-fecha-small { width: 60px; padding: 10px; font-size: 1.2rem; border-radius: 10px; border: 2px solid #d63384; outline: none; text-align: center; color: #d63384; font-family: 'Fredoka', sans-serif; }
        .input-anio { width: 80px; } 
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }

        /* Reproductor */
        #music-player-box {
            position: fixed; bottom: 20px; right: 20px;
            background: var(--card-bg); padding: 15px;
            border-radius: var(--player-radius);
            border: var(--player-border);
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.3);
            z-index: 1000; width: 260px; text-align: center; transition: transform 0.3s;
        }
        body.stardew-mode #music-player-box { box-shadow: 4px 4px 0px #3e2723; }
        #music-player-box:hover { transform: translateY(-5px); }
        .song-title { font-size: 0.9rem; font-weight: bold; color: var(--primary-color); margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }
        .controls { display: flex; justify-content: center; gap: 15px; margin-bottom: 8px; }
        .ctrl-btn { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-color); transition: color 0.2s; }
        .ctrl-btn:hover { color: var(--primary-color); }
        input[type=range] { width: 80%; accent-color: var(--primary-color); height: 4px; cursor: pointer; }

        /* Elementos flotantes y fondo */
        #frase-flotante-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; }
        .frase-flotante { 
            position: absolute; width: 100%; text-align: center;
            color: var(--primary-color); font-size: 1.5rem; font-weight: bold; 
            text-transform: uppercase; text-shadow: 2px 2px 0 white; 
            white-space: nowrap; animation: floatUp 4s ease-out forwards; 
        }
        body.stardew-mode .frase-flotante { text-shadow: 2px 2px 0 #000; }
        @keyframes floatUp { 0% { transform: translateY(0) scale(0.8); opacity: 0; } 20% { opacity: 1; transform: translateY(-20px) scale(1.1); } 100% { transform: translateY(-200px) scale(1); opacity: 0; } }

        .side-item { position: fixed; top: 110vh; font-size: 3rem; user-select: none; cursor: pointer; z-index: 50; animation: riseUp linear forwards; transition: transform 0.1s; }
        @keyframes riseUp { to { transform: translateY(-120vh) rotate(360deg); } }
        .confetti { position: fixed; width: 10px; height: 10px; pointer-events: none; z-index: 999; opacity: 0; }
        @keyframes pop { 0% { transform: translate(0, 0) rotate(0deg); opacity: 1; } 100% { transform: translate(var(--x), var(--y)) rotate(720deg); opacity: 0; } }

        .heart-bg { position: fixed; color: #ffb6c1; font-size: 2rem; user-select: none; z-index: 1; cursor: pointer; transform-style: preserve-3d; transition: opacity 0.5s; }
        body.stardew-mode .heart-bg { display: none; }
        #youtube-player { position: fixed; bottom: 0; left: 0; width: 1px; height: 1px; opacity: 0.01; pointer-events: none; z-index: -1; }

        /* =========================================
           ESTILOS DEL PERRO STARDEW (SPRITES)
           ========================================= */
        #stardew-dog {
            position: fixed;
            bottom: 20px; 
            left: 10vw;   
            width: 32px;  
            height: 32px; 
            background-image: url('stardew-dog-sprites.png'); 
            background-repeat: no-repeat;
            image-rendering: pixelated; 
            transform: scale(4) scaleX(1); 
            transform-origin: bottom center;
            z-index: 80; 
            display: none; 
            
            /* --- CLAVE PARA QUE NO HAYA BUGS: NO INTERACTUABLE --- */
            pointer-events: none; 
            
            /* La transici√≥n se aplica S√ìLO al movimiento (left) */
            /* Evitamos que 'background-position' tenga transici√≥n para que no se vea el "barrido" de sprites */
            transition: left linear; 
        }

        body.stardew-mode #stardew-dog { display: block; }
        #stardew-dog.dog-flip { transform: scale(4) scaleX(-1); }

        /* --- ESTADOS DE ANIMACI√ìN --- */

        /* 1. SENTADO BAJANDO (Se ejecuta 1 vez y para) */
        .dog-state-sit-start {
            background-position-y: -128px; 
            animation: spriteAnim4Frames 0.5s steps(4) 1 forwards;
        }

        /* 2. SENTADO IDLE (Bucle de los ultimos 2 frames) */
        .dog-state-sit-idle {
            background-position-y: -128px;
            animation: spriteSitIdleLoop 0.8s steps(2) infinite;
        }

        /* 3. CAMINANDO (Walk) - Fila 2 */
        .dog-state-walk {
            background-position-y: -32px; 
            animation: spriteAnim4Frames 0.6s steps(4) infinite;
        }

        /* 4. CORRIENDO (Run) - ULTIMA FILA */
        .dog-state-run {
            background-position-y: -288px; 
            animation: spriteAnim3Frames 0.4s steps(3) infinite;
        }

        /* 5. DURMIENDO (Sleep) - Fila 8 */
        .dog-state-sleep {
            background-position-y: -224px; 
            animation: spriteAnim2Frames 1.5s steps(2) infinite;
        }

        /* KEYFRAMES */
        @keyframes spriteAnim4Frames { from { background-position-x: 0; } to { background-position-x: -128px; } }
        @keyframes spriteAnim3Frames { from { background-position-x: 0; } to { background-position-x: -96px; } } 
        @keyframes spriteAnim2Frames { from { background-position-x: 0; } to { background-position-x: -64px; } }
        
        @keyframes spriteSitIdleLoop { 
            from { background-position-x: -64px; } 
            to { background-position-x: -128px; } 
        }

    </style>
</head>
<body>

    <div class="bg-tunnel"></div>
    <div class="bg-stardew"></div>
    
    <div id="hearts-container"></div>

    <div id="stardew-dog" class="dog-state-sit-idle"></div>

    <button id="btn-toggle-mode" onclick="cambiarModo()">üåæ Modo Stardew</button>

    <div class="corner-sticker bottom-left" id="sticker1">üéÄ</div>
    <div class="corner-sticker bottom-right" id="sticker2">üéÄ</div>

    <div id="pantalla-bloqueo">
        <div class="caja-login">
            <h1 style="font-size: 2rem; margin-top: 0; text-transform: uppercase;">üîí TENES QUE DESBLOQUEAR LA PAGINA üîí</h1>
            <p>Ingresa la fecha (D√≠a / Mes / A√±o)</p>
            <div class="fecha-inputs-container">
                <input type="number" id="input-dia" class="input-fecha-small" placeholder="DD" min="1" max="31">
                <span style="font-size: 1.5rem; color: var(--primary-color)">/</span>
                <input type="number" id="input-mes" class="input-fecha-small" placeholder="MM" min="1" max="12">
                <span style="font-size: 1.5rem; color: var(--primary-color)">/</span>
                <input type="number" id="input-anio" class="input-fecha-small input-anio" placeholder="AAAA" min="2020">
            </div>
            <br>
            <button class="btn-entrar" style="margin-top: 25px;" onclick="verificarFecha()">ENTRAR ‚ù§Ô∏è</button>
            <p id="mensaje-error" style="color:red; display:none; margin-top:20px;">Ups, esa no es. Pista: es una fecha muy especial jeje</p>
        </div>
    </div>

    <div id="contenido-principal" style="opacity: 0; transition: opacity 2s ease;">
        <div id="frase-flotante-container"></div>
        <div id="side-items-container"></div>
        <div id="youtube-player"></div>

        <div id="music-player-box">
            <div id="radio-header" style="margin-bottom: 10px; border-bottom: 2px dashed var(--primary-color); padding-bottom: 5px;">
                <div id="radio-title" style="font-weight:bold; font-size: 1.1rem; color: var(--primary-color); text-transform: uppercase;">LA RADIO DEL AMOR üìª</div>
                <div id="radio-subtitle" style="font-size: 0.8rem; font-style: italic;">te dedico todas amor</div>
            </div>
            <span class="song-title" id="current-song-title">Cargando m√∫sica...</span>
            <div class="controls">
                <button class="ctrl-btn" onclick="prevSong()">‚èÆÔ∏è</button>
                <button class="ctrl-btn" onclick="togglePlay()" id="play-btn">‚è∏Ô∏è</button>
                <button class="ctrl-btn" onclick="nextSong()">‚è≠Ô∏è</button>
            </div>
            <input type="range" min="0" max="100" value="50" oninput="setVolume(this.value)">
        </div>

        <div class="container">
            <h1>üíó ¬°FELIZ MES JUNTOS, AMOR! üíó</h1>
            <div id="contador">Calculando...</div>
            
            <div class="gallery" id="gallery-normal">
                <div class="photo-card" style="transform: rotate(-3deg);">
                    <img src="foto1.jpg" alt="Foto 1">
                    <p>üíó ¬°TE AMO</p>
                </div>
                <div class="photo-card" style="transform: rotate(3deg);">
                    <img src="foto2.jpg" alt="Foto 2">
                    <p>A CADA</p>
                </div>
                <div class="photo-card" style="transform: rotate(-2deg);">
                    <img src="foto3.jpg" alt="Foto 3">
                    <p>SEGUNDO! üíó</p>
                </div>
            </div>

            <div class="gallery" id="gallery-stardew" style="display: none;">
                <div class="photo-card" style="transform: rotate(-3deg);">
                    <img src="foto4.jpg" alt="Foto 4">
                    <p>‚≠ê ¬°POR</p>
                </div>
                <div class="photo-card" style="transform: rotate(3deg);">
                    <img src="foto5.jpg" alt="Foto 5">
                    <p>MUCHOS</p>
                </div>
                <div class="photo-card" style="transform: rotate(-2deg);">
                    <img src="foto6.jpg" alt="Foto 6">
                    <p>MESES M√ÅS! ‚≠ê</p>
                </div>
            </div>

            <div class="carta-section">
                <div class="papel-carta">
                    <div style="text-align: center;"><h2>üíå CARTA PARA VOS</h2></div>
                    <div id="cuerpo-carta"></div>
                    <span id="cursor-carta" class="cursor-carta"></span>
                </div>
            </div>

            <div class="utility-section">
                <div class="utility-box">
                    <h3 class="utility-title">üìÖ PR√ìXIMAS FECHAS</h3>
                    <ul class="date-list" id="lista-fechas"></ul>
                </div>
                <div class="utility-box">
                    <h3 class="utility-title">üé≤ ¬øQU√â HACEMOS HOY?</h3>
                    <div id="idea-display">¬°Presiona para una idea!</div>
                    <button class="btn-idea" onclick="generarCita()">üí° Tirar Idea</button>
                </div>
            </div>

            <button class="btn-frases" onclick="lanzarSorpresa()">‚ú® BOT√ìN AMOROSO ‚ú®</button>
        </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        /* --- CONFIGURACI√ìN GENERAL --- */
        const mensajeCarta = `Hola mi amor! ‚ù§Ô∏è\n\n¬°Feliz d√≠a a nosotrooos! Quer√≠a hacer algo distinto, as√≠ que me puse a armar esta p√°gina para vos (cost√≥ pero funca jasjas).\n\nGracias por ser mi compa√±era en todo amor, por bancarme en todas, por estar ahi siempre y por esas carcajadas que nos mandamos siempre. Amo cada momento con vos, ya sea saliendo a comer, viciando, mirando algo, es que quiero compartir todo con vos no importa que.\n\nEstoy super feliz de tu nuevo trabajo, se que ha sido meses duros sin ver una luz, pero al fin pudiste alcanzar este puestito hermoso que tenes. Estoy orgulloso en la mujer que te estas convirtiendo, poco a poco te armas tu carrera profesional jeje üòö. Espero que en esta nueva etapa de tu vida te vaya de mejor en mejor, que Dios te re acompa√±e siempre y sabes OBVIAMENTE que podes confiar en mi en lo que quieras, estar√© para siempre con vos en todos los lugares que vayas.\n\nAsi como estoy en las buenas, obvio estar√© en las malas, cuando todo vaya mal, cuando tropieces, cuando tengas un mal d√≠a, mala racha, quiero estar ah√≠ para apoyarte y darte todo mi amor. Se que soy medio pesado a veces, pero quiero mejorar en lo que soy para vos y para nuestro futuro juntitos üíóüíóüíóüíó\n\nSos mi negrita hermosa y te elijo todos los d√≠as.\n\n¬°Te amo con todo mi ser! üòöüòöüíó`;
        const fechaCorrecta = "05/03/2023";
        const frases = ["TE AMO CON TODO MI SER", "TE ELIJO A VOS CADA DIA", "TE EXTRA√ëOOO üò≠üò≠", "AGUANTEN LOS SHAWARMA", "TE ADORO MI NEGRA BELLA", "ME COSTO HACER ESTO PERO FUNCA VISTE", "MI NEGRITA MI TODO TE AMU üòö", "QUE PINTA VICIAR? ü•µü•µ", "MI BEBITA FIU FIUUUU", "YA TE QUIERO VOLVER A VER AMOR :(", "TE MANDO MIL BESITOS üòö", "OTRO DIA M√ÅS SIENDO NOVIOSS SIUU", "quiero plata", "6767676767", "DOOOUUU", "no hagaaaaaaaaaas ü§™", "TE ADORO", "TE AMOOO", "TE QUIEROO"];
        const ideasCitas = ["üçï Noche de Pizzas o cualquier morfi", "üé¨ Marat√≥n en pijama", "üë©‚Äçüç≥ Cocinar juntos", "üå≥ Salidaaaaa (donde sea)", "üç∑ Cena rom√°ntica", "üéÆ Tarde de juegos"];
        const playlistNormal = [{ id: 'GxldQ9eX2wo', title: 'Stephen Sanchez - Until I Found You' }, { id: 'dvgZkm1xWPE', title: 'Viva La Vida - Coldplay' }, { id: 'tk0ezF46sAc', title: 'Llunr - Rocketship' }, { id: 'g09UoqOKHx0', title: 'Conociendo Rusia - "Quiero que me llames"' }, { id: 'iTrJ3q5Ocpc', title: 'Conociendo Rusia - "Te lo voy a decir"' }, { id: '5wwhkhT_wEs', title: 'Conociendo Rusia - "A la vez"' }, { id: '2PH7dK6SLC8', title: 'John Mayer - New Light' }, { id: 'fopSgMkWEUk', title: 'Julieta Venegas - Limon Y Sal' }, { id: 'QQcQDbpDH_o', title: 'Cinema - Skrillex' }, { id: 'MzNWX0xL3mA', title: 'We Become We - Journey To Bethlehem' }, { id: 'D4bKwi7gRUA', title: 'Koino Yokan - Lo Que Va A Venir' }];
        const playlistStardew = [{ id: 'JJCFQtTPq_8', title: 'Stardew Valley OST (Relaxing)' }, { id: '2NihzptRjto', title: 'Infinity Castle Theme | Demon slayer' }, { id: 'faqmNf_fZlE', title: 'Hunter X Hunter Opening 1 | Departure!' }, { id: 'ih2BwMX_ilI', title: 'Hunter x Hunter Ending | 2' }, { id: 'HBAmFuEWPhE', title: 'Hunter x Hunter Ending l 6' }, { id: 'st4wcpjZeQQ', title: 'Demon Slayer - Opening 3' }, { id: 'g3HIQ0gdzYc', title: 'Hunter x Hunter Ending | 5' }, { id: 'IVBU9ymY', title: 'Hunter x Hunter Ending | 4' }];

        let currentPlaylist = playlistNormal;
        let isStardewMode = false;

        /* --- L√ìGICA DEL PERRO (AUT√ìNOMA SIN CLICKS) --- */
        const dog = document.getElementById('stardew-dog');
        let dogState = 'sit-idle'; 
        let dogPos = 10; 
        let targetPos = 10; 
        let isMoving = false;

        function updateDogAI() {
            if (!isStardewMode) return; 

            // Si se est√° moviendo, no interrumpir NUNCA.
            if (isMoving) return;

            // Si est√° durmiendo, 2% chance de despertar
            if (dogState === 'sleep') {
                if (Math.random() > 0.98) sitDogDown();
                return;
            }

            // Si est√° sentado (idle) y quieto
            if (dogState === 'sit-idle') {
                const rand = Math.random();
                if (rand < 0.02) {
                    // 2% chance de dormir
                    changeDogState('sleep');
                } else if (rand < 0.1) {
                    // 8% chance de moverse
                    startMove();
                }
            }
        }

        function startMove() {
            targetPos = Math.random() * 80 + 5; 
            
            // Determinar si corre o camina
            const runChance = Math.random() > 0.5;
            const duration = runChance ? 1.5 : 4.0;
            const mode = runChance ? 'run' : 'walk';

            // Mirar a la direcci√≥n correcta
            const direction = targetPos > dogPos ? 1 : -1; 
            if (direction === 1) dog.classList.remove('dog-flip');
            else dog.classList.add('dog-flip');

            // Iniciar movimiento
            changeDogState(mode);
            dog.style.transition = `left ${duration}s linear`;
            dog.style.left = targetPos + 'vw';
            dogPos = targetPos;
            isMoving = true;

            // Agendar la parada
            setTimeout(() => {
                isMoving = false;
                sitDogDown();
            }, duration * 1000);
        }

        // Funci√≥n para sentarse suavemente
        function sitDogDown() {
            changeDogState('sit-start');
            setTimeout(() => {
                // Solo pasar a idle si seguimos en sit-start
                if (dog.classList.contains('dog-state-sit-start')) {
                    changeDogState('sit-idle');
                }
            }, 500);
        }

        function changeDogState(newState) {
            dogState = newState;
            dog.className = ''; 
            // Mantener volteado si la √∫ltima acci√≥n fue a la izquierda
            if (targetPos < dogPos || (isMoving && targetPos < dogPos)) dog.classList.add('dog-flip'); 
            dog.classList.add('dog-state-' + newState);
        }

        setInterval(updateDogAI, 1000);


        /* --- LOGICA DOBLE MUNDO --- */
        function cambiarModo() {
            const body = document.body;
            const btn = document.getElementById("btn-toggle-mode");
            const sticker1 = document.getElementById("sticker1");
            const sticker2 = document.getElementById("sticker2");
            const galleryNormal = document.getElementById("gallery-normal");
            const galleryStardew = document.getElementById("gallery-stardew");
            const radioTitle = document.getElementById("radio-title");
            const radioSubtitle = document.getElementById("radio-subtitle");

            isStardewMode = !isStardewMode;

            if (isStardewMode) {
                body.classList.add("stardew-mode");
                btn.innerText = "üéÄ Volver a la Normalidad";
                sticker1.innerText = "‚≠ê"; sticker2.innerText = "üíô";
                galleryNormal.style.display = "none"; galleryStardew.style.display = "flex";
                radioTitle.innerText = "RADIO STARDEW üêî"; radioSubtitle.innerText = "Musiquita para la granja";
                currentPlaylist = playlistStardew;
                
                // Resetear perro al entrar al modo
                dog.style.transition = 'none'; // Quitar transici√≥n para reset inmediato
                sitDogDown(); isMoving = false;

            } else {
                body.classList.remove("stardew-mode");
                btn.innerText = "üåæ Modo Stardew";
                sticker1.innerText = "üéÄ"; sticker2.innerText = "üéÄ";
                galleryNormal.style.display = "flex"; galleryStardew.style.display = "none";
                radioTitle.innerText = "LA RADIO DEL AMOR üìª"; radioSubtitle.innerText = "te dedico todas amor";
                currentPlaylist = playlistNormal;
            }
            currentIdx = 0; if(player) player.loadVideoById(currentPlaylist[0].id);
            updatePlayerUI();
        }

        /* --- FUNCIONES GENERALES --- */
        function verificarFecha() {
            let dia = document.getElementById("input-dia").value.padStart(2, '0');
            let mes = document.getElementById("input-mes").value.padStart(2, '0');
            const anio = document.getElementById("input-anio").value;
            if (`${dia}/${mes}/${anio}` === fechaCorrecta) {
                document.getElementById("pantalla-bloqueo").style.opacity = "0";
                const btnMode = document.getElementById("btn-toggle-mode");
                btnMode.style.opacity = "1"; btnMode.style.pointerEvents = "auto";
                setTimeout(() => {
                    document.getElementById("pantalla-bloqueo").style.display = "none";
                    document.getElementById("contenido-principal").style.opacity = "1";
                    iniciarMecanografia(); if(player) player.playVideo();
                    iniciarSideItems(); calcularProximasFechas();
                }, 1000);
            } else { document.getElementById("mensaje-error").style.display = "block"; }
        }

        let charIndex = 0; function iniciarMecanografia() { if (charIndex < mensajeCarta.length) { const char = mensajeCarta.charAt(charIndex); document.getElementById("cuerpo-carta").innerHTML += char === '\n' ? '<br>' : char; charIndex++; setTimeout(iniciarMecanografia, 50); } else { document.getElementById("cursor-carta").style.display = "none"; } }

        const emojisNormal = ["üéà", "üß∏", "üåª", "üíñ", "üç¶", "‚ú®", "ü¶ã", "üå∏", "üåπ", "üå∑", "üíê", "‚ù§Ô∏è", "üß°", "üíõ", "üíö", "üíô", "üíú", "ü§ç"];
        const emojisStardew = ["üåæ", "üêî", "‚≠ê", "üçÑ", "üå≤"];
        function iniciarSideItems() { setInterval(crearSideItem, 800); }
        function crearSideItem() {
            const container = document.getElementById("side-items-container"); const item = document.createElement("div"); item.classList.add("side-item");
            item.innerText = isStardewMode ? emojisStardew[Math.floor(Math.random() * emojisStardew.length)] : emojisNormal[Math.floor(Math.random() * emojisNormal.length)];
            item.style.left = (Math.random() > 0.5 ? Math.random() * 10 + 2 : Math.random() * 10 + 85) + "vw";
            item.style.animationDuration = (Math.random() * 5 + 5) + "s";
            item.onclick = function(e) { lanzarConfeti(e.clientX, e.clientY); item.style.transform = "scale(1.5)"; item.style.opacity = "0"; setTimeout(() => item.remove(), 200); };
            container.appendChild(item); setTimeout(() => { item.remove(); }, 10000);
        }
        function crearCorazones() {
            const container = document.getElementById("hearts-container"); container.innerHTML = "";
            for (let i = 0; i < 30; i++) { const heart = document.createElement("div"); heart.classList.add("heart-bg"); heart.innerHTML = emojisNormal[Math.floor(Math.random() * emojisNormal.length)]; heart.style.left = Math.random() * 95 + "vw"; heart.style.top = Math.random() * 95 + "vh"; heart.style.fontSize = (Math.random() * 2 + 1) + "rem"; heart.style.animation = `float ${Math.random() * 3 + 2}s infinite ease-in-out alternate`; heart.onclick = function(e) { lanzarConfeti(e.clientX, e.clientY); this.style.opacity = "0"; setTimeout(() => this.remove(), 500); }; container.appendChild(heart); }
        }
        function lanzarConfeti(x, y) { const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500']; if (!x) x = window.innerWidth / 2; if (!y) y = window.innerHeight / 2; for (let j = 0; j < 20; j++) { const confeti = document.createElement('div'); confeti.classList.add('confetti'); confeti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)]; confeti.style.left = x + 'px'; confeti.style.top = y + 'px'; const dirX = (Math.random() - 0.5) * 200 + 'px'; const dirY = (Math.random() - 1) * 200 + 'px'; confeti.style.setProperty('--x', dirX); confeti.style.setProperty('--y', dirY); confeti.style.animation = `pop ${Math.random() * 0.5 + 0.5}s ease-out forwards`; document.body.appendChild(confeti); setTimeout(() => { confeti.remove(); }, 1000); } }
        function lanzarSorpresa() { lanzarFrase(); lanzarConfeti(window.innerWidth/2, window.innerHeight * 0.8); }
        function lanzarFrase() { const container = document.getElementById("frase-flotante-container"); const el = document.createElement("div"); el.classList.add("frase-flotante"); el.innerText = frases[Math.floor(Math.random() * frases.length)]; el.style.left = (Math.random() * 30 - 15) + "%"; el.style.top = "60%"; container.appendChild(el); setTimeout(() => { el.remove(); }, 4000); }
        function calcularProximasFechas() { const lista = document.getElementById("lista-fechas"); lista.innerHTML = ""; const meses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"]; const dias = ["Domingo", "Lunes", "Martes", "Mi√©rcoles", "Jueves", "Viernes", "S√°bado"]; let hoy = new Date(); for(let i = 0; i < 4; i++) { let mesActual = hoy.getMonth() + i; let anioActual = hoy.getFullYear(); if (mesActual > 11) { mesActual -= 12; anioActual++; } let fechaFutura = new Date(anioActual, mesActual, 5); if (fechaFutura < new Date()) fechaFutura = new Date(anioActual, mesActual + 1, 5); const item = document.createElement("li"); item.classList.add("date-item"); item.innerHTML = `<span>5 de ${mesesNombres[fechaFutura.getMonth()]}</span> <span style="font-weight:bold; color:var(--primary-color)">${dias[fechaFutura.getDay()]}</span>`; lista.appendChild(item); } }
        function generarCita() { const display = document.getElementById("idea-display"); display.style.opacity = 0; setTimeout(() => { display.innerText = ideasCitas[Math.floor(Math.random() * ideasCitas.length)]; display.style.opacity = 1; }, 200); }
        const fechaInicio = new Date("2023-03-05T00:00:00"); function actualizarContador() { const ahora = new Date(); const diferencia = ahora - fechaInicio; const dias = Math.floor(diferencia / (1000 * 60 * 60 * 24)); const horas = Math.floor((diferencia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); const minutos = Math.floor((diferencia % (1000 * 60 * 60)) / (1000 * 60)); const segundos = Math.floor((diferencia % (1000 * 60)) / 1000); const anios = Math.floor(dias / 365); const diasRestantes = dias % 365; document.getElementById("contador").innerHTML = `LLEVAMOS: ${anios} A√ëOS, ${diasRestantes} D√çAS, ${horas} HS, ${minutos} MIN Y ${segundos} SEG`; } setInterval(actualizarContador, 1000); crearCorazones();

        /* --- YOUTUBE API --- */
        let player; let currentIdx = 0; let isPlaying = false;
        function onYouTubeIframeAPIReady() { player = new YT.Player('youtube-player', { height: '1', width: '1', videoId: currentPlaylist[currentIdx].id, playerVars: { 'autoplay': 0, 'controls': 0, 'origin': window.location.origin }, events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange } }); }
        function onPlayerReady(event) { updatePlayerUI(); player.setVolume(50); }
        function onPlayerStateChange(event) { if (event.data === YT.PlayerState.ENDED) nextSong(); if (event.data === YT.PlayerState.PLAYING) { isPlaying = true; document.getElementById("play-btn").innerText = "‚è∏Ô∏è"; } if (event.data === YT.PlayerState.PAUSED) { isPlaying = false; document.getElementById("play-btn").innerText = "‚ñ∂Ô∏è"; } }
        function updatePlayerUI() { document.getElementById("current-song-title").innerText = currentPlaylist[currentIdx].title; }
        function togglePlay() { if (player) { if (isPlaying) player.pauseVideo(); else player.playVideo(); } }
        function nextSong() { currentIdx++; if (currentIdx >= currentPlaylist.length) currentIdx = 0; if(player) player.loadVideoById(currentPlaylist[currentIdx].id); updatePlayerUI(); }
        function prevSong() { currentIdx--; if (currentIdx < 0) currentIdx = currentPlaylist.length - 1; if(player) player.loadVideoById(currentPlaylist[currentIdx].id); updatePlayerUI(); }
        function setVolume(val) { if (player) player.setVolume(val); }
    </script>
</body>
</html>
